---
import { languages } from "../i18n/ui";
import { getRelativeLocaleUrl } from "astro:i18n";

const currentLang = Astro.currentLocale || "es";
---

<div class="language-switcher">
    {
        Object.entries(languages).map(([code, label]) => (
            <a
                href={getRelativeLocaleUrl(code, "/")}
                class:list={["lang-btn", { active: currentLang === code }]}
                aria-label={`Switch to ${label}`}
            >
                <span class="lang-text">{code.toUpperCase()}</span>
                <div class="lang-glow" />
            </a>
        ))
    }
</div>

<style>
    .language-switcher {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        background: rgba(0, 0, 0, 0.3);
        padding: 0.25rem;
        border-radius: 8px;
        border: 1px solid rgba(0, 255, 136, 0.2);
        backdrop-filter: blur(5px);
    }

    .lang-btn {
        position: relative;
        padding: 0.25rem 0.5rem;
        border-radius: 6px;
        color: #a1a1aa;
        font-size: 0.75rem;
        font-weight: 700;
        font-family: "Courier New", monospace;
        text-decoration: none;
        transition: all 0.3s ease;
        overflow: hidden;
    }

    .lang-btn:hover {
        color: #fff;
    }

    .lang-btn.active {
        color: #00ff88;
        background: rgba(0, 255, 136, 0.1);
        border: 1px solid rgba(0, 255, 136, 0.3);
        box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .lang-glow {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
            45deg,
            transparent,
            rgba(0, 255, 136, 0.1),
            transparent
        );
        transform: translateX(-100%);
        transition: transform 0.3s ease;
    }

    .lang-btn:hover .lang-glow {
        transform: translateX(100%);
    }

    /* Glitch effect on hover for non-active */
    .lang-btn:not(.active):hover .lang-text {
        animation: glitch 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both
            infinite;
    }

    @keyframes glitch {
        0% {
            transform: translate(0);
        }
        20% {
            transform: translate(-1px, 1px);
        }
        40% {
            transform: translate(-1px, -1px);
        }
        60% {
            transform: translate(1px, 1px);
        }
        80% {
            transform: translate(1px, -1px);
        }
        100% {
            transform: translate(0);
        }
    }
</style>
